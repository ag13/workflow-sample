(this["webpackJsonpworkflow-sample"]=this["webpackJsonpworkflow-sample"]||[]).push([[0],{141:function(e,t,a){e.exports=a(173)},146:function(e,t,a){},147:function(e,t,a){},173:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(13),l=a.n(o),c=(a(146),a(147),a(40)),s=a(17),i=a(65),u=a.n(i),m=a(132),f=a(55),w=a(80),d=a(11),p=a(36),E=a(50),b=a(19),h=a(25),v=a(15),g=a(209),k=a(212),y=a(208),O=a(210),j=a(123),C=a.n(j),x=a(203),S=Object(x.a)((function(e){return{sheetTitle:{padding:0,margin:"0 0 24px 24px",textAlign:"left"},drawer:{width:440,flexShrink:0},drawerPaper:{width:440},boxAlign:{textAlign:"right"}}})),I=function(e){var t=e.isOpen,a=void 0!==t&&t,n=e.title,o=e.handleClose,l=e.children,c=S();return r.a.createElement(g.a,{className:c.drawer,variant:"persistent",anchor:"right",open:a,classes:{paper:c.drawerPaper}},r.a.createElement(k.a,{className:c.sheetTitle},r.a.createElement(y.a,{className:c.boxAlign},r.a.createElement(O.a,{onClick:o},r.a.createElement(C.a,null))),n),l)},N=a(98),T=function(e){var t=e.isOpen,a=e.header,n=e.body;return r.a.createElement("div",{style:{position:"absolute",top:0,right:0}},r.a.createElement(N.a,{show:t,delay:3e3,autohide:!0},r.a.createElement(N.a.Header,null,r.a.createElement("strong",{className:"mr-auto"},a)),r.a.createElement(N.a.Body,null,n)))};function A(e,t){var a=Object(n.useState)((function(){try{var a=window.localStorage.getItem(e);return a?JSON.parse(a):t}catch(n){return t}})),r=Object(d.a)(a,2),o=r[0],l=r[1];return[o,Object(n.useCallback)((function(t){try{e&&(l(t),window.localStorage.setItem(e,JSON.stringify(t)))}catch(a){console.log(a)}}),[e])]}var D=a(131),R=function(e){var t,a=e.workflowType,o=e.onNodeClick,l=Object(n.useCallback)((function(e){if("node1"===e.id)return r.a.createElement("button",{onClick:function(){return alert("test")}},"Test")}),[]);return r.a.createElement(D.a,{id:"diagram",width:"100%",height:"550px",ref:function(e){return t=e},nodeTemplate:l,created:function(e){console.log("nodes created ere"),a.nodes.forEach((function(e){t.add(e)})),a.connectors.forEach((function(e){t.add(e)}))},click:function(e){if(e){var t=e.actualObject;if(t){var a=t.properties.annotations[1];o&&o(a)}}}})},F=function(e){var t=e.type,a=e.workflowId,o=e.onNodeClick,l=e.isView,c=void 0!==l&&l,s=e.onStatusChange,i=Object(n.useState)({}),m=Object(d.a)(i,2),p=m[0],E=m[1],b=Object(n.useState)({}),h=Object(d.a)(b,2),v=h[0],g=h[1],k=Object(n.useState)("In Progress"),y=Object(d.a)(k,2),O=(y[0],y[1],Object(n.useState)([])),j=Object(d.a)(O,2),C=j[0],x=j[1],S=Object(n.useState)({}),I=Object(d.a)(S,2),N=I[0],T=I[1],D=A("ws:workflows",[]),F=Object(d.a)(D,1)[0],P="#E5ECE2";return Object(n.useEffect)((function(){var e=function(){var e=Object(w.a)(u.a.mark((function e(){var t,n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch("http://ec2-3-129-9-103.us-east-2.compute.amazonaws.com:8888/workflow/history/".concat(a),{method:"GET"});case 2:if(!(t=e.sent).ok){e.next=11;break}return e.next=6,t.json();case 6:n=e.sent,console.log(n),T(n),e.next=12;break;case 11:console.error("Not able to get workflow details");case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();c&&(console.log("fetc"),e())}),[a,c]),Object(n.useEffect)((function(){if(N&&N.history){console.log("workflowHistory",N),N.history.forEach((function(e){var t=e.stage,a=e.state;"Workflow"===t&&"COMPLETED"===a&&s&&s("Completed")}));var e=N.history.filter((function(e){return"WorkflowExecutionSignaled"===e.eventType}));x(e)}}),[N]),Object(n.useEffect)((function(){if(console.log(t),t&&"sequential"===t.toLowerCase()){var e={nodes:[{id:"node1",height:100,width:100,offsetX:200,offsetY:100,style:{fill:P},annotations:[{content:"Step 1 - Document Selection"},{stepType:"documentUpload",stepNumber:"one"}]},{id:"node2",height:100,width:100,offsetX:400,offsetY:100,style:{fill:P},annotations:[{content:"Step 2 - Document Review"},{stepType:"singleReview",stepNumber:"two"}]},{id:"node3",height:100,width:100,offsetX:600,offsetY:100,style:{fill:P},annotations:[{content:"Step 3 - Document Review"},{stepType:"singleReview",stepNumber:"three"}]}],connectors:[{id:"connector1",sourceID:"node1",targetID:"node2"},{id:"connector2",sourceID:"node2",targetID:"node3"}]};c?g(e):(console.log("seq",e),E(e))}else if("parallel"===t.toLowerCase()){var a={nodes:[{id:"node1",height:100,width:100,offsetX:200,offsetY:100,style:{fill:P},annotations:[{content:"Step 1 - Document Selection"},{stepType:"documentUpload",stepNumber:"one"}]},{id:"node2",height:100,width:100,offsetX:400,offsetY:100,style:{fill:P},annotations:[{content:"Step 2 - Document Review"},{stepType:"multiReview",stepNumber:"two"}]}],connectors:[{id:"connector1",sourceID:"node1",targetID:"node2"}]};c?g(a):E(a)}}),[t,c]),Object(n.useEffect)((function(){var e=F.filter((function(e){return e.id!==a}));if(console.log("historyWithStages",C,e),e.length&&"sequential"===t.toLowerCase()){C&&!C.length&&E(Object(f.a)({},v));for(var n=function(e){switch(C[e].state){case"APPROVED":E((function(t){var a=Object(f.a)({},v);return a.nodes[e].style.fill="#61FF33",console.log("filled wit green"),a}));break;case"REJECTED":E((function(t){var a=Object(f.a)({},v);return a.nodes[e].style.fill="#FA2116",a}));break;case null:E((function(t){var a=Object(f.a)({},v);return a.nodes[e].style.fill="white",a}));break;default:return{v:null}}},r=0;r<C.length;r++){var o=n(r);if("object"===typeof o)return o.v}}else t.toLowerCase()}),[a,t,C]),r.a.createElement(r.a.Fragment,null,p&&p.nodes&&p.nodes.length&&r.a.createElement(R,{workflowType:p,onNodeClick:o,onStatusChange:s}))},P=a(62),W=a(71),L=a(51),G=function(){var e=Object(L.b)(),t=e.values,a=e.setFieldValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,null,"Select reviewers to review"),r.a.createElement(P.a,{id:"basic-typeahead-multiple",name:"reviewers",labelKey:"name",multiple:!0,onChange:function(e){e&&a("reviewers",e)},options:["Pritam","Ashish","Anupam"],placeholder:"Choose reviewers...",selected:t.reviewers})))},J=function(e){var t=e.fetchedWorkflow,a=Object(n.useState)({}),o=Object(d.a)(a,2),l=o[0],c=o[1];return Object(n.useEffect)((function(){var e={step:2,reviewers:[{name:"Apoorva",status:"In Progress"},{name:"Aniva",status:"Not started"}]};console.log(e),c(e)}),[t]),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,{as:h.a,controlId:"formPlaintextEmail"},r.a.createElement(b.a.Label,{column:!0,sm:"12"},"Reviewers"),r.a.createElement(v.a,{sm:"10"},l&&l.reviewers&&r.a.createElement(W.a,null,l.reviewers.map((function(e){return r.a.createElement(W.a.Item,null,e.name," - ",e.status)}))))))},V=function(){var e=Object(L.b)(),t=e.values,a=e.setFieldValue;return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,null,"Select document to review"),r.a.createElement(P.a,{id:"basic-typeahead-single",name:"selectedDocument",labelKey:"name",onChange:function(e){e&&a("selectedDocument",e)},options:["F24H Wizard","MadCap Flare POC"],placeholder:"Choose a document...",selected:t.selectedDocument})))},Y=function(e){var t=e.workflowId,a=Object(n.useState)({}),o=Object(d.a)(a,2),l=o[0],c=o[1],s=A("ws:workflows",[]),i=Object(d.a)(s,1)[0];return Object(n.useEffect)((function(){var e=i.filter((function(e){return e.workflowId===t}));if(e){var a={document:e[0].stepConfiguration.selectedDocument[0]};c(a)}}),[t,i]),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,{as:h.a,controlId:"formPlaintextEmail"},r.a.createElement(b.a.Label,{column:!0,sm:"12"},"Document to review"),r.a.createElement(v.a,{sm:"10"},r.a.createElement(b.a.Control,{plaintext:!0,readOnly:!0,value:l.document}))))},q=function(e){var t=e.nodeType,a=e.stepNumber,o=Object(L.b)(),l=o.values,c=o.setFieldValue,s=Object(n.useState)([]),i=Object(d.a)(s,2),u=i[0],m=i[1];Object(n.useEffect)((function(){"multiReview"===t?m(["Pritam","Ashish","Anupam"]):"singleReview"===t&&("one"===a?m(["John Doe","Jane Doe"]):"two"===a?m(["Akhil","Ashwini"]):"three"===a?m(["Auro","Chitra"]):"four"===a&&m(["Shubho","Biplap"]))}),[t,a]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,null,r.a.createElement(b.a.Label,null,"Select reviewer to review"),r.a.createElement(P.a,{id:"basic-typeahead-multiple",name:"reviewers-".concat(a),labelKey:"name",onChange:function(e){e&&c("reviewers-".concat(a),e)},options:u,placeholder:"Choose reviewer...",selected:l["reviewers-".concat(a)]||[]})))},z=function(e){var t=e.workflowId,a=e.stepNumber,o=Object(n.useState)({}),l=Object(d.a)(o,2),c=l[0],s=l[1],i=A("ws:workflows",[]),u=Object(d.a)(i,1)[0];return Object(n.useEffect)((function(){var e=u.filter((function(e){return e.workflowId===t}));if(e){var n={reviewer:e[0].stepConfiguration["reviewers-".concat(a)]};console.log(n,a),s(n)}}),[t,a,u]),r.a.createElement(r.a.Fragment,null,r.a.createElement(b.a.Group,{as:h.a,controlId:"formPlaintextEmail"},r.a.createElement(b.a.Label,{column:!0,sm:"12"},"Reviewer"),r.a.createElement(v.a,{sm:"10"},c&&c.reviewer&&r.a.createElement(W.a,null,r.a.createElement(W.a.Item,null,c.reviewer[0])))))},B=a(206),U=a(207),X=a(89),H=a.n(X),K=function(){var e=Object(n.useState)(""),t=Object(d.a)(e,2),a=t[0],o=t[1],l=Object(n.useState)(""),c=Object(d.a)(l,2),i=c[0],g=c[1],k=Object(n.useState)(!1),y=Object(d.a)(k,2),O=y[0],j=y[1],C=Object(n.useState)(!1),x=Object(d.a)(C,2),S=x[0],N=(x[1],Object(n.useState)(!1)),D=Object(d.a)(N,2),R=D[0],P=D[1],W=Object(s.f)().type,J=Object(s.e)(),Y=A("ws:workflows",[]),z=Object(d.a)(Y,2),X=z[0],K=z[1],M=function(e){e&&(o(e.stepType),g(e.stepNumber),j(!0))},$=function(){j(!1)},Q=Object(n.useCallback)((function(){if(a)switch(a){case"documentUpload":return r.a.createElement(V,null);case"multiReview":return r.a.createElement(G,null);case"singleReview":return r.a.createElement(q,{nodeType:a,stepNumber:i});default:return null}}),[a,i]),Z=function(){var e=Object(w.a)(u.a.mark((function e(t){var a,n,r,o,l,c,s;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("values",t),e.next=3,fetch("http://ec2-3-129-9-103.us-east-2.compute.amazonaws.com:8888/workflow/initiate",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({workflowType:W,name:t.workflowName})});case 3:if(!(a=e.sent).ok){e.next=16;break}return P(!0),e.next=8,a.json();case 8:n=e.sent,r=n.workflowId,o=n.workflowType,l=n.name,(c={workflowId:r,workflowType:o,name:l,stepConfiguration:Object(f.a)({},t)}).workflowId&&(s=[].concat(Object(m.a)(X),[c]),K(s),J.push("/workflows/")),e.next=16;break;case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return r.a.createElement(L.a,{initialValues:{selectedDocument:[],reviewers:[],workflowName:""},onSubmit:Z},(function(e){var t=e.handleSubmit,a=e.handleChange;return r.a.createElement(b.a,{onSubmit:t},r.a.createElement(E.a,{fluid:!0},r.a.createElement(h.a,{style:{margin:"20px"}},r.a.createElement(v.a,{xs:4,style:{textAlign:"left"}},r.a.createElement("h4",null,"Create Workflow")),r.a.createElement(v.a,{xs:4},r.a.createElement(b.a.Group,{controlId:"formWorkflowName"},r.a.createElement(b.a.Control,{type:"text",name:"workflowName",onChange:a}),r.a.createElement(b.a.Text,{className:"text-muted"},"Give your workflow a name"))),r.a.createElement(v.a,{xs:2},r.a.createElement(p.a,{variant:"primary",type:"submit"},"Start Workflow")),r.a.createElement(v.a,{xs:2},r.a.createElement("span",null,"Status: ",r.a.createElement(H.a,{style:{color:"grey"}}),"Not Started"))),r.a.createElement(h.a,null,r.a.createElement(v.a,null,r.a.createElement(F,{type:W,onNodeClick:M}),r.a.createElement(I,{isOpen:O,handleClose:$,title:"Step Configuration"},r.a.createElement(B.a,null,Q()),r.a.createElement(U.a,null,r.a.createElement(p.a,{variant:"light",onClick:$},"Close"))))),r.a.createElement(T,{isOpen:S,header:"Workflow Configuration",body:"Saved step configuration"}),r.a.createElement(T,{isOpen:R,header:"Workflow",body:"New workflow started"})))}))},M=function(){var e=Object(s.f)(),t=e.workflowId,a=e.type,o=Object(n.useState)(""),l=Object(d.a)(o,2),c=l[0],i=l[1],u=Object(n.useState)("In Progress"),m=Object(d.a)(u,2),f=m[0],w=m[1],b=Object(n.useState)(""),g=Object(d.a)(b,2),k=g[0],y=g[1],O=Object(n.useState)(!1),j=Object(d.a)(O,2),C=j[0],x=j[1],S=function(){x(!1)},N=Object(n.useMemo)((function(){if(console.log("stepnumber",k,t),c)switch(c){case"documentUpload":return r.a.createElement(Y,{workflowId:t});case"multiReview":return r.a.createElement(J,{workflowId:t});case"singleReview":return r.a.createElement(z,{workflowId:t,stepNumber:k});default:return null}}),[c,t,k]);return r.a.createElement(r.a.Fragment,null,r.a.createElement(E.a,{fluid:!0},r.a.createElement(h.a,{style:{margin:"20px"}},r.a.createElement(v.a,{xs:6,style:{textAlign:"left"}},r.a.createElement("h4",null,"View Workflow")),r.a.createElement(v.a,{xs:3},r.a.createElement("span",null,"Status: ",r.a.createElement(H.a,{style:{color:"grey"}}),f))),r.a.createElement(h.a,null,r.a.createElement(v.a,null,r.a.createElement(F,{type:a,workflowId:t,onNodeClick:function(e){e&&(i(e.stepType),y(e.stepNumber),console.log(e.stepNumber),x(!0))},isView:!0,onStatusChange:function(e){w(e)}}),r.a.createElement(I,{isOpen:C,handleClose:S,title:"Step Configuration"},r.a.createElement(B.a,null,N),r.a.createElement(U.a,null,r.a.createElement(p.a,{variant:"light",onClick:S},"Cancel")))))))},$=a(211),Q=function(){var e={display:"flex",justifyContent:"center"},t=Object(s.f)(),a=t.id,o=t.stage,l=Object(n.useState)(!1),c=Object(d.a)(l,2),i=c[0],u=c[1],m=Object(n.useState)(""),f=Object(d.a)(m,2),w=f[0],b=f[1],g=function(e){fetch("http://ec2-3-129-9-103.us-east-2.compute.amazonaws.com:8888/acknowledgement/",{method:"POST",body:JSON.stringify({workflowId:a,level:o,value:e}),headers:{"Content-type":"application/json; charset=UTF-8"}}).then((function(e){console.log("Response after Approval",e)})).catch((function(e){return console.error("Received Error while posting via acknowledge service: ",e)}))};return r.a.createElement(E.a,{fluid:!0},r.a.createElement(h.a,{style:{margin:"20px",borderBottom:"1px solid black"}},r.a.createElement("h3",null," WorkFlow Approval Page")),r.a.createElement(h.a,{style:{margin:"30px"}},r.a.createElement(v.a,{xs:2,style:e},r.a.createElement("h4",null,"1")),r.a.createElement(v.a,{xs:4,style:e},r.a.createElement("h4",null,"First Workflow")),r.a.createElement(v.a,{xs:3,style:e},r.a.createElement(p.a,{variant:"success",onClick:function(){u(!0),b("Workflow has been Approved"),g("approve")}}," Approve ")),r.a.createElement(v.a,{xs:3,style:e},r.a.createElement(p.a,{variant:"danger",onClick:function(){u(!0),b("Workflow has been Rejected"),g("reject")}}," Reject "))),i&&r.a.createElement($.a,{anchorOrigin:{vertical:"top",horizontal:"center"},open:i,onClose:function(){u(!1)},ContentProps:{"aria-describedby":"message-id"},message:r.a.createElement("span",{id:"message-id"},w)}))},Z=(a(170),a(171),a(129)),_=a(77),ee=a(130),te=function(){var e=Object(s.e)(),t=A("ws:workflows",[]),a=Object(d.a)(t,1)[0];return r.a.createElement(E.a,{fluid:!0},r.a.createElement(h.a,{style:{margin:"20px"}},r.a.createElement(v.a,{xs:6,style:{textAlign:"left"}},r.a.createElement("h3",null,"Your Workflows")),r.a.createElement(v.a,{xs:6,style:{display:"flex",justifyContent:"flex-end"}},r.a.createElement(Z.a,{id:"dropdown-item-button",title:"Create Workflows"},r.a.createElement(_.a.Item,{as:c.b,to:"/workflows/create/sequential"},"Sequential Review"),r.a.createElement(_.a.Item,{as:c.b,to:"/workflows/create/parallel"},"Parallel Review")))),r.a.createElement(h.a,{style:{margin:"40px"}},r.a.createElement(ee.a,{striped:!0,bordered:!0,hover:!0},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",null,"ID"),r.a.createElement("th",null,"Name"),r.a.createElement("th",null,"Type"))),r.a.createElement("tbody",null,a.map((function(t){return r.a.createElement("tr",{key:t.workflowId,style:{cursor:"pointer"},onClick:function(){return function(t){if(t&&t.workflowId){var a=t.workflowType.toLowerCase();e.push("/workflows/view/".concat(a,"/").concat(t.workflowId))}}(t)}},r.a.createElement("td",null,t.workflowId),r.a.createElement("td",null,t.name),r.a.createElement("td",null,t.workflowType))}))))))},ae=function(){return r.a.createElement(te,null)};var ne=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(c.a,{basename:"/"},r.a.createElement(s.a,{exact:!0,path:"/",component:ae}),r.a.createElement(s.a,{exact:!0,path:"/workflows/",component:te}),r.a.createElement(s.a,{exact:!0,path:"/workflows/create/:type",component:K}),r.a.createElement(s.a,{exact:!0,path:"/workflows/view/:type/:workflowId",component:M}),r.a.createElement(s.a,{exact:!0,path:"/workflows/approval/:id/:stage",component:Q})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(ne,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[141,1,2]]]);
//# sourceMappingURL=main.f8159bb6.chunk.js.map